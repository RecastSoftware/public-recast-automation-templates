# CVE-2025-47981

This Recast Automation  attempts to help find devices in your environment that are vulnerable to CVE-2025-47981. This builder action will evaluate the targeted devices and place potentially vulnerable endpoints in a collection of your choice. https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2025-47981

## How to implement
1. Import the CVE-2025-47981.xml into your builder console
1. Create a collection for CVE-2025-47981 and note the CollectionID
1. Run the Recast Automation against a group of devices, enter the Collection ID when prompted
1. Review the members of the specified collection

## Builder steps
1. Prompt for Collection ID
1. Runs a PowerShell script that
    * Checks the HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\pku2u\AllowOnlineID registry key to determine if it is set to 1
    * Checks the current patch level against the minimum required patch levels necessary to be protected
1. Devices with older patch levels and AllowOnlineID set to 1 are marked as vulnerable and placed in the specified collection
    * Note that because in some situations PKU2U can be enabled even if this key is non-existant, we are counting those as potential failures and placing them in the collection as well.