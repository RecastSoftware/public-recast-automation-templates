# CVE-2025-53770

This Recast Automation attempts to help remediate sharepoint servers in your environment that are vulnerable to CVE-2025-53770. This builder action will evaluate the targeted devices, trigger updates if missing, and configure settings outlined in the customer guidance for the Sharepoint vulnerability. https://msrc.microsoft.com/blog/2025/07/customer-guidance-for-sharepoint-vulnerability-cve-2025-53770/

> Please use caution and test before running in a production environment!! 
> This automation is provided as a best effort starting point to help get you started.

## How to implement
1. Import the CVE-2025-53770.xml into your builder console
1. Run the Recast Automation against a Sharepoint server
1. Enter in the required information
    * Require AMSI - Yes or No
    * HotfixID for your Sharepoint version https://msrc.microsoft.com/blog/2025/07/customer-guidance-for-sharepoint-vulnerability-cve-2025-53770/
    * WebApplicationURL and Binding (unique to the Sharepoint environment)
1. Review results

## Builder steps
1.	Prompt for several things
    * Whether to enable AMSI
    * The HotfixID for the version of sharepoint the user has
    * WebApplicationURL and Binding (unique to the sharepoint environment)
2.	Check if the inputted KB is installed
    * If not, install available patches from configmgr and quit automation
3.	If KB is installed and the user chose to enable AMSI, run powershell script to enable it
4.	Run PowerShell command to rotate ASP.NET keys
